<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jisell Howe">
<meta name="dcterms.date" content="2020-03-01">

<title>JH - Sankey Charts - Creating a Fun Slide in Tableau Public</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<style>
    .quarto-title-block .quarto-title-banner {
      background-image: url(../banner-moody.jpg);
background-size: cover;
    }
    </style>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">JH</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">About</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../posts.html">Blog</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../resume.html">Résumé</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../featured.html">Industry Features</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../speakertradingcards.html">Speaker Trading Cards</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://public.tableau.com/app/profile/jisell.howe#!/">Data Viz (Tableau Public)</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/jisellhowe"><i class="bi bi-linkedin" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ji53ll"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://data-folks.masto.host/web/@jisell#"><i class="bi bi-mastodon" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/ji5ell"><i class="bi bi-twitter" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.youtube.com/@jisellhowe"><i class="bi bi-youtube" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Sankey Charts - Creating a Fun Slide in Tableau Public</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">tableau</div>
                <div class="quarto-category">sankeychart</div>
                <div class="quarto-category">analysis</div>
                <div class="quarto-category">makeovermonday</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Jisell Howe </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 1, 2020</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>A Sankey diagram is a data visualization technique that shows flow from one point to another. The flows help show connections between a beginning and a possible end.</p>
<p>This week’s <a href="https://www.makeovermonday.co.uk/data/">MakeoverMonday</a> challenge focused on the housing outcomes of clients of the Australian Specialist Homelessness Services. Clients could go from one housing situation to a multitude of other housing situations. Because of this, I decided to make use of a Sankey chart to show where the flows were going.</p>
<p>This became a bit of a challenge because the <a href="https://www.youtube.com/watch?v=1HwCzlA9hI4">tutorials</a> I saw on how to make one in Tableau seemed to reference features that Tableau Desktop would have but not Tableau Public.</p>
<p>However, I got one to work and I will show you how I made it!</p>
<section id="creating-a-sankey-chart" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-sankey-chart"><strong>Creating a Sankey Chart</strong></h3>
<p>The most crucial part in creating this diagram is dealing with the source data itself. Because the data needs to flow from one area to another, we need to tell Tableau to understand that within the same data set. For that reason, I dragged and dropped the Data sheet into the box below.</p>
<p>I<img src="1_Union.png" class="img-fluid"></p>
<p>The next step is to then drag and drop over that same sheet again to Union it with the first one. I then edited the connection to make sure it created a union. This creates a new column that will differentiate “Data” and “Data1.”</p>
<p><img src="2_Union-1024x617.png" class="img-fluid"></p>
<p>From here, I went into the worksheet and started creating some calculated fields.</p>
</section>
<section id="creating-the-curve-of-the-sankey-chart" class="level3">
<h3 class="anchored" data-anchor-id="creating-the-curve-of-the-sankey-chart"><strong>Creating the Curve of the Sankey Chart</strong></h3>
<p><img src="3_Calculated-Field-1.png" class="img-fluid"></p>
<p>This first one will help build a flow pathway between the “two” data sources. This calculated field will separate the “two” by assigning them to a number. This says if it exists in the one data set, then it’ll be assigned a 1. If not, then it’ll be assigned a 49. In the end this field won’t be on any shelf for the data visualization, but it’ll help us build the curve with subsequent calculated fields.</p>
<p><img src="4_Calculated-Field-1.png" class="img-fluid"></p>
<p>After I created this calculated field, I then right clicked to create a bin to essentially build a bridge between 1 and 49, the two data sets.</p>
<p><img src="5_Create-Bin.png" class="img-fluid"></p>
<p>What this will do is not only have 1 to 49 between the two data sets but it’ll also put numbers in between to help build that “bridge.”</p>
<p><img src="6_Padded.png" class="img-fluid"></p>
<p>This next part here might look like random things are being done, but actually we will be utilizing a mathematical function to build all the curved lines between the two data sets. This calculated field is part of that formula and will help space everything out, much like how I did for my jitter plot tutorial post.</p>
<p><img src="7_Index.png" class="img-fluid"></p>
<p>Here is the function we are trying to simulate. It’s called Sigmoid function, and as you’ll see in the next couple steps, it uses t from the calculated field that was just created. This will create the “S” shape between the two data sets.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://en.wikipedia.org/wiki/Sigmoid_function"><img src="8_Sigmoid-Formula.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">Image from Wikipedia</figcaption><p></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="https://en.wikipedia.org/wiki/Sigmoid_function"><img src="9_Sigmoid-Curve.png" class="img-fluid figure-img"></a></p>
<p></p><figcaption class="figure-caption">Image from Wikipedia</figcaption><p></p>
</figure>
</div>
<p>Here is how that function plays out in Tableau when we create yet another calculated field.</p>
<p><img src="10_Sigmoid.png" class="img-fluid"></p>
<p>Next, we need to rank each data set, so the Sigmoid function knows to flow from one point to another point.</p>
<p><img src="11_Rank-Calculated-Field.png" class="img-fluid"></p>
<p><img src="12_Rank-Calculated-Field.png" class="img-fluid"></p>
<p>Now we can finally build the curve with all the different parts.</p>
<p><img src="13_Curve.png" class="img-fluid"></p>
</section>
<section id="refining-the-curve-for-the-sankey-chart" class="level3">
<h3 class="anchored" data-anchor-id="refining-the-curve-for-the-sankey-chart"><strong>Refining the Curve for the Sankey Chart</strong></h3>
<p>Drag Padded to the details on the marks card and drag t to the columns shelf. Right click to Compute Using &gt; Padded. Drag Curve to the rows shelf. As you can see, we’re finally getting somewhere!</p>
<p><img src="14_Curve.png" class="img-fluid"></p>
<p>Right click on either t or Curve and go to Edit Table Calculation. This will open up a prompt where you can specify how the calculations are done. This first one shows that Rank1 will be computed using Specific Dimensions such as Client situation at first presentation, Client situation at end of support, and Padded.</p>
<p><img src="15_Table-Calculation-Rank-1-1024x652.png" class="img-fluid"></p>
<p>The little drop down arrow next to Rank1 will then let you go to the next nested calculation to configure Rank2. Rank2 will be computing the same things as Rank1. And here is what the nested calculation t will need.</p>
<p><img src="16_Table-Calculation-t-1024x691.png" class="img-fluid"></p>
</section>
<section id="formatting" class="level3">
<h3 class="anchored" data-anchor-id="formatting"><strong>Formatting</strong></h3>
<p>Now for my favorite part, formatting things and making it all come to life.</p>
<p><img src="17_Formatting.png" class="img-fluid"></p>
<p>We can right click and edit the axis on t and Curve to clean things up a little bit.</p>
<p><img src="18_Edit-Axis.png" class="img-fluid"></p>
<p><img src="19_Edit-Axis-1024x674.png" class="img-fluid"></p>
<p>Now, we want the data to show lines, not circles. To do that, we will need to change the marks to be lines and then drag the Padded bin to path. As you recall, that Padded pill had data points from 1 to 49 all spaced out. Now this creates that same bridge, but as lines.</p>
<p><img src="20_Path.png" class="img-fluid"></p>
<p>Here I created yet another calculated field because I want these lines to be thicker or thinner based on the number of clients that follow that path.</p>
<p><img src="21_Size-of-Clients.png" class="img-fluid"></p>
<p>Here’s how to put that calculated field to work.</p>
<p><img src="22_Size-of-Clients.png" class="img-fluid"></p>
<p>Then we can go to the change the size on the marks card.</p>
<p><img src="23_Size-of-Clients.png" class="img-fluid"></p>
</section>
<section id="creating-the-pillar-columns" class="level3">
<h3 class="anchored" data-anchor-id="creating-the-pillar-columns"><strong>Creating the Pillar Columns</strong></h3>
<p>This next part involves additional worksheet tabs. I wanted to create a couple columns to go on each side of the Sankey diagram. One column will show the proportions of where people were at in their housing situations at first presentation and the next column will be where they are at after receiving support. These columns will act as “pillars” for the Sankey chart to flow between. I created this first column for “Before” and then duplicated the worksheet to slightly modify it for “After.”</p>
<p><img src="24_Percent-of-Total_begin.png" class="img-fluid"></p>
<p><img src="25_Compute-Using.png" class="img-fluid"></p>
<p><img src="26_Left-Column.png" class="img-fluid"></p>
<p><img src="27_Right-Column.png" class="img-fluid"></p>
<p>I then went back to the Sankey Chart worksheet and dragged Client situation at first presentation pill to the colors on the marks card. I’m not a huge fan of the colors because it just looks like a ton of colors at once and is a little hard on the eyes. I later changed these colors.</p>
<p><img src="28_Sankey-Color-Before-only-1024x609.png" class="img-fluid"></p>
<p>In the dashboard view, I decided to use floating objects to help position the columns on each side of the Sankey chart. Had I used tiled, it would have wanted to line up everything but might not have done exactly what I wanted.</p>
<p><img src="29_Dashboard-View-1024x685.png" class="img-fluid"></p>
</section>
<section id="actions" class="level3">
<h3 class="anchored" data-anchor-id="actions"><strong>Actions</strong></h3>
<p>To help deal with the color all over the place, I decided to utilize actions in the dashboard to help highlight only what I wanted when someone hovered over a section. In this case, if you hovered over a specific housing situation in the the “Before” column, it would then highlight all the paths that went elsewhere in the “After” column. This would show that people not necessarily kept the same housing situation after getting support.</p>
<p><img src="30_Actions.png" class="img-fluid"></p>
<p><img src="31_Actions.png" class="img-fluid"></p>
</section>
<section id="the-final-data-visualization" class="level3">
<h3 class="anchored" data-anchor-id="the-final-data-visualization"><strong>The Final Data Visualization</strong></h3>
<p>Here is what I came up with in the end. And <a href="https://public.tableau.com/views/MakeoverMonday2020Wk8AustralianHomelessness/Housing?:display_count=y&amp;:origin=viz_share_link">here is the interactive data visualization</a>. It was a bit of a challenge to make this chart do what I wanted from loosely following this <a href="https://www.youtube.com/watch?v=1HwCzlA9hI4">tutorial</a>. Ultimately, I would have loved if all the Sankey curves could have been gray and then I could highlight in color what I wanted when the Before and After columns were hovered over.</p>
<p>I couldn’t quite figure that one out for this, and the highlighting actions tutorials I explored seemed to not follow the Sankey curve and created straight lines of highlighting, which is not what I wanted. If anyone has any tips on how to make better highlighting actions for a Sankey curve specifically, please do let me know!</p>
<p><img src="32_Final-Viz.png" class="img-fluid"></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>